import{g as H,r as K,a as Q}from"./index-RazWJMKj.js";import{d as W,r as c,B as X,a as Y,e as o,c as x,o as v,b as a,w as l,k as u,h as n,i as Z,q as ee,N as te,S as w,O as p,_ as ae}from"./index-CDtMGLGq.js";const le=["src"],oe=["src"],re=W({__name:"index",setup(se){let f=c(1),y=c(3),b=c(0),k=c([]);const m=async()=>{const e=await H(f.value,y.value);b.value=e.data.total,k.value=e.data.records},h=e=>{y.value=e,m()},N=e=>{f.value=e,m()},V=()=>{d.value=!0},D=e=>{d.value=!0,Object.assign(r,e)},O=async e=>{(await K(e)).code===w?(p({type:"success",message:"删除成功"}),m()):p({type:"error",message:"删除失败"})};X(()=>{m()});const C=()=>({id:void 0,tmName:"",logoUrl:""});let d=c(!1),g=c(),r=Y(C());const z=()=>{var e;(e=g.value)==null||e.resetFields(),Object.assign(r,C())},M={tmName:[{required:!0,validator:(e,t,s)=>{t.trim().length<2?s(new Error("品牌名称长度必须大于等于2")):s()},trigger:"change"}],logoUrl:[{required:!0,validator:(e,t,s)=>{!t||t.length===0?s(new Error("请上传品牌LOGO")):s()},trigger:"blur"}]},T=e=>{var t;r.logoUrl=e.data,(t=g.value)==null||t.validateField("logoUrl")},E=e=>{if(e.type==="image/png"||e.type==="image/jpg"||e.type==="image/jpeg"||e.type==="image/gif")return e.size/1024/1024<4?!0:(p({type:"error",message:"文件大小必须小于4M"}),!1);p({type:"error",message:"文件必须为JPG|PNG|GIF格式"})},S=()=>{d.value=!1},P=async()=>{var e;await((e=g.value)==null?void 0:e.validate().then(async()=>{(await Q(r)).code===w?(p({type:"success",message:r.id?"修改成功":"添加成功"}),d.value=!1,m()):p({type:"error",message:r.id?"修改失败":"添加失败"})}).catch(()=>{p({type:"error",message:"请检查表单的错误信息并修正"})}))};return(e,t)=>{const s=o("el-button"),_=o("el-table-column"),j=o("el-popconfirm"),A=o("el-table"),B=o("el-pagination"),G=o("el-card"),L=o("el-input"),U=o("el-form-item"),q=o("Plus"),F=o("el-icon"),I=o("el-upload"),R=o("el-form"),$=o("el-dialog");return v(),x("div",null,[a(G,{class:"box-card"},{default:l(()=>[a(s,{type:"primary",size:"default",icon:"Plus",onClick:V},{default:l(()=>t[2]||(t[2]=[u(" 添加品牌 ")])),_:1}),a(A,{data:n(k),style:{margin:"10px 0"},"header-cell-style":{textAlign:"center"},"cell-style":{textAlign:"center"},border:""},{default:l(()=>[a(_,{label:"序号",prop:"id",width:"100px"}),a(_,{label:"品牌名称",prop:"tmName"}),a(_,{label:"品牌Logo"},{default:l(i=>[Z("img",{src:i.row.logoUrl,alt:"图片出错",style:{width:"100px",height:"100px"}},null,8,le)]),_:1}),a(_,{label:"品牌操作"},{default:l(i=>[a(s,{type:"primary",size:"small",icon:"Edit",onClick:J=>D(i.row)},{default:l(()=>t[3]||(t[3]=[u(" 编辑 ")])),_:2},1032,["onClick"]),a(j,{title:`你确定要删除${i.row.tmName}吗？`,onConfirm:J=>O(i.row.id)},{reference:l(()=>[a(s,{type:"danger",size:"small",icon:"Delete"},{default:l(()=>t[4]||(t[4]=[u(" 删除 ")])),_:1})]),_:2},1032,["title","onConfirm"])]),_:1})]),_:1},8,["data"]),a(B,{onSizeChange:h,onCurrentChange:N,"current-page":n(f),"page-sizes":[3,5,7,9],background:!0,"page-size":n(y),layout:"prev, pager, next, jumper, -> ,sizes, total",total:n(b)},null,8,["current-page","page-size","total"])]),_:1}),a($,{modelValue:n(d),"onUpdate:modelValue":t[1]||(t[1]=i=>te(d)?d.value=i:d=i),title:n(r).id?"修改品牌":"添加品牌",onClose:z},{footer:l(()=>[a(s,{onClick:S},{default:l(()=>t[5]||(t[5]=[u("取 消")])),_:1}),a(s,{type:"primary",onClick:P},{default:l(()=>t[6]||(t[6]=[u("确 定")])),_:1})]),default:l(()=>[a(R,{style:{width:"80%"},ref_key:"addOrUpdateTradeMarkFormDataRef",ref:g,model:n(r),rules:M},{default:l(()=>[a(U,{label:"品牌名称",prop:"tmName","label-width":"100px"},{default:l(()=>[a(L,{placeholder:"请输入品牌名称",modelValue:n(r).tmName,"onUpdate:modelValue":t[0]||(t[0]=i=>n(r).tmName=i)},null,8,["modelValue"])]),_:1}),a(U,{label:"品牌LOGO","label-width":"100px",prop:"logoUrl"},{default:l(()=>[a(I,{class:"avatar-uploader",action:"/api/admin/product/fileUpload","show-file-list":!1,"on-success":T,"before-upload":E},{default:l(()=>[n(r).logoUrl?(v(),x("img",{key:0,src:n(r).logoUrl,class:"avatar"},null,8,oe)):(v(),ee(F,{key:1,class:"avatar-uploader-icon"},{default:l(()=>[a(q)]),_:1}))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}}),ce=ae(re,[["__scopeId","data-v-06085612"]]);export{ce as default};
